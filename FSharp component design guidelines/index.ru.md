Эта статья является [переводом](https://github.com/fsharp/fsfoundation/blob/5ecbebc5bbe1e16486551c1117bd2c42fce25cb0/specs/component-design-guidelines/index.md)

Этот документ является сборником методических рекомендаций по программированию на языке F#, и основан на документе [The F# Component Design Guidelines, v14, Microsoft Research](http://fsharp.org/specs/component-design-guidelines/fsharp-design-guidelines-v14.pdf). Документ поддерживается технической командой F#, включая Дона Сайма и других участников F# Core Engineering Group.

Этот документ подразумевает что вы знакомы с языком F#. Выражаем большую благодарность сообществу за отзывы по его содержимому.

## 1. Обзор

Данный документ охватывает несколько проблем проектирования компонентов на языке F#, а именно:

* Методические рекомендации по написанию библиотек, предназначенных для их использования из кода на языке F#, и написанию кода на языке F#.

* Рекомендации по стилю оформления кода на языке F#.

* Рекомендации по написанию библиотек, предназначенных для использования внутри экосистемы .NET, их использования из других .NET-совместимыми языков.

F# обычно называют языком с ориентацией на парадигму функционального программирования(functional-first): он поддерживает как функциональную, объектно-ориентированную, и императивную парадигмы. Тем не менее, первой, обычно, является пардигма функционального программирования. Множество стандартных конструкций F# подталкивают к ее использованию, но это не значит, что две другие парадигмы неэффиктины, а даже наоборот, использование их вместе оптимально. Это распространенное заблуждение, что функциональная и объектно-ориентированная парадигмы конкуриют между собой. На самом деле, они в большей степени дополняют друг друга, чем противоречат. Например, функциональная парадигма играет большую роль на "малом" уровне(уровне реализации методов или функций), когда как объектная парадигма играет большую роль "в масштабе"(на уровне классов, интерфейсов, организации пространств имен, дизайне API и библиотек). Хорошее руководство по функциональному программированию можно найти на [fsharpforfunandprofit.com](http://fsharpforfunandprofit.com).

Вне зависимости от методологии проектироващик компонентов и библиотек встречается с рядом прозаических и практических проблем во время их дизайна, ведь их API должен быть как можно более доступен для разработчиков. Одна из сильных сторон платформы .NET это унифицированная модель программирования, независимая от языка программирования. Целостность и согласованность стандартной библиотеки .NET это результат осознанного следованния указаний по организации и оформлению из [.NET Library Design Guidelines](http://msdn.microsoft.com/en-us/library/vstudio/ms229042(v=vs.100).aspx). Это направляет проектировщика к созданию согласованного набора API, который позволяет использовать компоненты из других языков программирования .NET, вне зависимости от языка реализации этих компонентов.

Как к языку программирования среды .NET, к языку F# применяются те же рекомендации и соглашения по проектированию .NET компонентов и библиотек. Однако, у языка F# есть ряд уникальных особенностей, свои синтаксические конструкции и идиомы, которые собственно и являются предметом данного документа. Даже если вы пишете небольшие скрипты(scripts), имеет смысл с ними ознакомится, так как скрипты имеют свойство превращаться в переиспользоваемые библиотеки в обозримом будущем.

Рекомендации и методологии проектирования компонентов .NET описываются в рамках соглашений и рекомендаций для использования их при написании следующих конструкций:

* Сборки, пространства имен, типы

* Классы и интерфейсы, содержащие свойства, методы и события

* Делегаты

* Перечисления (перечисления из языков, таких как C#)

* Константы (константы из языков, таких как C#)

* Параметры типов (обобщенные(generic) параметры)

С перспекты языка F# необходимо так же учесть следующие конструкции:

* Алгебраические типы(union-types) и записи(records)

* Значения и функции, объвяленные через let и let rec

* Модули

* Типы-функции

* Именованные параметры, опциональные параметры и методы расширения

* Тип Option и кортежи(tuple)

* Асинхронные констркции языка F#

Задача хорошо спроектировать библиотеку под фреймворк достаточно нетривиальна и сложность ее часто недооценивается. Для языка F# рекомендации основаны на том факте, что среда .NET является объектно-ориентированной, и в этом документе мы представляем наши рекомендации как к этому подойти. Как и в случае с документом .NET Library Design Guidelines они не являются единственым правильным подходом, и конечные решения так или иначе зависят от проектировщиков и программистов.

Отправной точкой всех решений является то, проектируете ли вы компоненты эксклюзивно для среды F#, или для среды .NET в целом, например для вызова компонентов из языка C#. Если вы планируете использовать компоненты только в среде F#, то программисты могут и должны использовать все преимущества данного языка и его конструкций, которые являются его исключительной и сильной стороной. Не смотря на тот факт, что даже в этом случае эти компоненты будет возможно переиспользовать из других языков платформы .NET, лучше использовать определенное подможество языка F# для этих целей, которое позволит предоставить идиоматически-правильное, знакомое и совместимое API для среды .NET Framework.

Разделы 2, 3 и 5 дают общие рекомендации по производству библиотек на F# в зависимости от ее потребителя. В разделе 2 представлены общие рекомендации для всех библиотек на F#. Потом, в Разделе 3 мы представим рекомендации по проектированию API исключительно для его использования из F#. В Разделе 5 мы описываем рекомендации для библиотек, которые планируется использовать из любых других языков среды .NET. В целом,  все эти разделы дают наши рекомендации по оформлению публичного API, предоставляемого сборкой F#.

Раздел 4 дает рекомендации по оформлению кода на F#. Когда как другие разделы сосредоточены на оформлении и проектировании компонентов, данный Раздел сосредоточен на рекомендациях относительно программирования на F# в целом(например, реализация внутренных коменнетов библиотеки).

Данный документ завершается приложением и расширенным примером проектирования.

## 2. Общие рекомендции

Есть несколько общих рекомендаций, которые универсальны для всех библиотек на F#, вне зависимости от конечного потребителя библиотеки, и они перечислены ниже. Самый первый пункт является первостепенным и отражает всю суть документа.

#### ✔ Будьте знакомы с документом .NET Library Design Guidelines

Вне зависимости от того что вы пишете на F#, знание общих рекомендация для среды .NET будет ценно, так как другие .NET разработчки будут так же знакомы с ним и будут ожидать их соблюдения от вашего кода.

Это так же может предполагать знакомство с программированием на языке C#.

Документ .NET Library Design Guidelines дает много общих рекомендаций относительно наименования, проектирования классов и интерфейсов, а так же их методов, свойств, событий, и так далее, что делает его очень ценным справочником относительно проектирования и оформления кода в целом.

#### ✔ Используйте XML-комментарии в коде

XML-комментарии на публичном API гарантируют, что у его потребителей будет работать Intellisense and Quickinfo во время использования типов и их членов. Это так же позволяет строить файлы документации для библиотек. Описание всех возможных тегов xml есть в докоментации по языку F#.

    /// Класс представляющий (x,y) координаты 
    type Point = 
    
        /// Считает расстояние между этой и другой точкой
        member DistanceTo : otherPoint:Point -> float

#### ✔ Рассмотрите возможность использования явных сигнатурных файлов (.fsi) для сформировавщихся и стабильных библиотек и компонентов

Использование сигнатурых файлов позволяет предоставить общий список все публичного API. Это помогает как и удостоверится в том, что вы понимаете все публичное пространство вашей библиотеки, так и предоставляет элегантное разделение внешней документации и внутренними деталами реализации. Стоит заметить, что с файлы .fsi затрудняют изменение публичного API, так как это приходится делать сразу в двух местах одновременно. Поэтому, сигнатурные файлы проще всего добавлять когда у вас уже сформировался публичный API, и его изменение маловероятно.
